# 更新记录（Changelog）

作者：CC

## v1.3.6（2026-02-27）
- 后端：`/api/services` 新增动作三态字段 `action_state_*`（`ok/partial/blocked`）和符号字段 `action_mark_*`（`√/-/x`），并保留旧字段兼容。
- 后端：统一动作三态判定逻辑（按当前用户权限、服务禁用状态、运维模式、动作能力）。
- 后端：`LocalProcService.get_info()` 补齐 `start_capable/stop_capable/restart_capable` 与本机语义的 `auto_restart_effective`。
- UI：服务维护列改为消费后端三态，不再前端重复推断；按钮样式区分 `√`、`-`、`x`。
- UI：操作状态列新增独立“自动重启开/关”按钮，并保留“切到只监控/恢复可维护”入口。
- 文档：README/用户手册/配置参考同步更新三态规则与新交互说明。

## v1.3.5（2026-02-27）
- UI：服务表格拆分为“运行状态 / 操作状态 / 服务维护”三列，减少信息混杂。
- UI：运行状态列仅保留异常、运行、未知、禁用四种状态，避免冗余标识。
- UI：操作状态列支持自动检测开关、频率修改、一键禁用、切到只监控/恢复可维护。
- UI：服务维护列统一展示启动/停止/重启/检测，缺失能力改为灰色“×”禁用样式。
- 逻辑：移除前端重复的失败策略切换入口，降低操作冲突与认知负担。
- 文档：同步更新 README、用户手册、配置参考和项目审计说明。

## v1.3.4（2026-02-27）
- UI：移除独立“策略列/频率列”，将失败策略、自动检测、频率、运维模式、禁用状态统一收敛到“状态列”。
- UI：状态列新增一级操作按钮，支持直接切换自动检测、修改频率、切换失败策略、切换只监控/可运维、禁用/启用。
- UI：失败策略显示增加“是否生效”提示，避免“自动重启已配置但当前不执行”的误解。
- UI：操作列去除重复能力徽章，仅保留启动/停止/重启/检测按钮，减少视觉冗余。
- 联动：后端服务信息新增 `auto_restart_effective` 字段，前端按实际可执行性展示策略状态。
- 文档：同步更新 README、用户手册、配置参考与审计文档的页面交互说明。

## v1.3.3（2026-02-27）
- UI：Unknown 状态调整为橙黄色，避免和 Running 颜色过近。
- UI：将“自动检测/频率、可运维/只监控、禁用状态”集中展示到服务状态列，信息更显性。
- UI：策略列中的“失败自动重启”改为文字徽章，不再仅靠小图标。
- UI：移除行内“管理”下拉，改为直接切换按钮（自动检测、运维模式、禁用）。
- UI：启动/停止/重启/检测增加 ✅/❌ 能力标识，操作可用性一眼可见。
- UI：日志弹窗增加去重创建，避免重复弹窗与ID冲突。
- UI：筛选后页码越界自动回退，避免出现空白页。
- 工程：加固 `.gitignore`；移除版本库内 `__pycache__/*.pyc` 和 `data/logs/*` 等运行态噪音文件。

## v1.3.2（2026-02-27）
- 健壮性：`/api/services`、`/api/errors`、`/api/events` 对非法 `page/page_size/days/n` 参数容错，不再触发500。
- 校验：`/api/admin/schedules` 严格校验 `check_schedule`，非法值返回 `400 invalid_check_schedule`。
- 校验：`/api/admin/bindings` 新增 `service_id` 存在性校验，不存在返回 `400 service_not_found`。
- 校验：`/api/control/<service_id>/<action>` 新增 action 白名单，非法 action 返回 `400 unsupported_action`。
- 语义：控制接口服务不存在时返回 `404 service_not_found`。

## v1.3.1（2026-02-26）
- UI：服务状态显示与策略列信息更清晰；支持运维模式一键切换。
- UI：服务表格顶部同步横向滚动条。
- 文档：统一“失败告警/自动重启/只监控/可运维”术语与说明。
